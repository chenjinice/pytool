<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <!-- 图标 -->
        <link rel="shortcut icon" type="image/x-icon" href="style/image/logo.ico" />
        <title>device</title>

        <link type="text/css" rel="stylesheet" href="style/css/stylesheet.css" />
        <!-- leaflet -->
        <link rel="stylesheet" href="js/leaflet/leaflet.css">
        <link rel="stylesheet" href="js/leaflet/MarkerCluster.css">
        <link rel="stylesheet" href="js/leaflet/MarkerCluster.Default.css">
        <script src="js/leaflet/leaflet.js"></script>
        <script src="js/leaflet/leaflet.markercluster-src.js"></script>
        <script src="js/leaflet/leaflet.rotatedMarker.js"></script>

        <!-- socketio -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script> -->
        <script src="js/socket-io-4.0.1/socket.io.js"></script>

        <!-- jquery -->
        <link rel="stylesheet" href="js/jquery-ui-1.11.4/jquery-ui.css">
        <script src="js/jquery-2.2.4/jquery.js"></script>
        <script src="js/jquery-2.2.4/jquery.cookie.js"></script>
        <script src="js/jquery-ui-1.11.4/jquery-ui.js"></script>
    
        <!-- 自己的js -->
        <script src="js/my/common_map.js"></script>
        <script src="js/my/device.js"></script>
    </head>
    
    <body>
	   	<div id = "googleMap"></div>

        <div id="div_control"></div>
        <div id="div_control_content">
            <div><input type="checkbox" id="switch_config"  />配置</div>
            <div><input type="checkbox" id="switch_tools" />按钮</div>
            <div>
                <select id = "map_type">
                  <option value="1">在线谷歌卫星</option>
                  <option value="2">在线谷歌普通</option>
                  <option value="101">本地谷歌卫星</option>
                  <option value="102">本地谷歌普通</option>
                </select>
            </div>
        </div>

        <div id = "bottom">
            <div id = "div_config">
                <input type="checkbox" id="follow" /><span>跟随</span>
                <input type="checkbox" id="bsm" /><span>bsm</span>
                <input type="checkbox" id="map" /><span>map</span>
                <input type="checkbox" id="rsi" /><span>rsi</span>
                <input type="checkbox" id="rsm" /><span>rsm</span>
                <input type="checkbox" id="spat" /><span>spat</span>
                <button id = "clear_cache">清除缓存</button>
            </div>
            <div id = "div_tools">
                经度 <input type="number" id="input_lng" value="" min="-180.0" max="180.0" oninput="if(value < -180)value=-180;if (value > 180) value=180" />
                纬度 <input type="number" id="input_lat" value="" min="-90.0" max="90.0" oninput="if(value < -90)value=-90;if (value > 90) value=90" />
                <button id = "addPoint">加点</button><span></span>
                <button id = "addCenterPoint">中心加点</button><span></span>
                <button id = "clear">清除</button>
            </div>
            <div id = "div_status">
                经纬度 : <span id="car_pos">       </span>
                航向角 : <span id="car_heading">  </span>
                速度 :   <span id="car_speed">    </span>
                卫星数 : <span id="car_num_st">    </span>
                hdop :   <span id="car_hdop">   </span>
                模式 :   <span id="car_model">  </span>
            </div>
        </div>

        <script>
        $(document).ready(function(){
            deviceInitAll();
			
			var cfg = getDevCfg();
            $("#follow").attr("checked",cfg.follow);
			$("#bsm").attr("checked",cfg.bsm);
			$("#map").attr("checked",cfg.map);
			$("#rsi").attr("checked",cfg.rsi);
			$("#rsm").attr("checked",cfg.rsm);
			$("#spat").attr("checked",cfg.spat);
            $("#follow").change(function()      {   setDevCfg("follow",$(this).prop('checked'));   });
			$("#bsm").change(function() 	    {	setDevCfg("bsm",$(this).prop('checked'));	});
			$("#map").change(function() 	    {	setDevCfg("map",$(this).prop('checked'));	});
			$("#rsi").change(function() 	    {	setDevCfg("rsi",$(this).prop('checked'));	});
			$("#rsm").change(function() 	    {	setDevCfg("rsm",$(this).prop('checked'));	});
			$("#spat").change(function()	    {	setDevCfg("spat",$(this).prop('checked'));	});
            $("#clear_cache").click(function()  {   clearCache();  });


            $( "#div_control" ).draggable().click(function() {
                $("#div_control_content").toggle().position({
                    my: "left top",
                    at: "left bottom",
                    of: this
                });
            });
            // $('body').click(function(){ alert(123); });
            if(cfg.div_config){ $("#div_config").show(); }else{ $("#div_config").hide(); }
            if(cfg.div_tools) { $("#div_tools").show();  }else{ $("#div_tools").hide(); }
            $("#switch_config").attr("checked",cfg.div_config).change(function()  {
                var obj  = $("#div_config");
                var flag = $(this).prop('checked'); 
                flag ? obj.show(200) : obj.hide(200);
                setDevCfg("div_config",flag);   
            });
            $("#switch_tools").attr("checked",cfg.div_tools).change(function()  {
                var obj  = $("#div_tools");
                var flag = $(this).prop('checked'); 
                flag ? obj.show(200) : obj.hide(200);
                setDevCfg("div_tools",flag);   
            });


            $("#addCenterPoint").click(function() { addMarkerAtCenter();          });
            $("#clear").click(function()          { clearAll();                });
            $("#addPoint").click(function()       { 
                var lng =  parseFloat($("#input_lng").val()).toFixed(7);
                var lat =  parseFloat($("#input_lat").val()).toFixed(7);
                addMarker(lng,lat,true);
            });
            $("#map_type").val(GKD.type.toString());
            $("#map_type").change(function()      { mapInit( parseInt($(this).val() ) );    });

        })
        </script>


	</body>

</html>
